<!DOCTYPE html>
<html>
<head>
    <title>Provider FCM Registration Test</title>
</head>
<body>
    <h1>Provider FCM Registration</h1>
    <div id="status">Checking...</div>
    <button id="registerBtn" style="display:none;">Register Provider for Notifications</button>
    <div id="logs"></div>

    <script>
        function log(msg) {
            const logs = document.getElementById('logs');
            logs.innerHTML += '<div>' + new Date().toLocaleTimeString() + ': ' + msg + '</div>';
            console.log(msg);
        }

        // Simulate provider registration
        async function registerProvider() {
            try {
                log('üîî Requesting notification permission...');
                const permission = await Notification.requestPermission();
                
                if (permission === 'granted') {
                    log('‚úÖ Permission granted');
                    
                    // Test provider FCM registration
                    const response = await fetch('/api/fcm/register', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            userId: 'test-provider-123',
                            userType: 'provider',
                            token: 'test-token-provider-' + Date.now()
                        })
                    });
                    
                    const result = await response.json();
                    log('üì± Registration result: ' + JSON.stringify(result));
                } else {
                    log('‚ùå Permission denied');
                }
            } catch (error) {
                log('‚ùå Error: ' + error);
            }
        }

        document.getElementById('registerBtn').addEventListener('click', registerProvider);
        document.getElementById('registerBtn').style.display = 'block';
        document.getElementById('status').textContent = 'Ready to test provider registration';
    </script>
</body>
</html>
